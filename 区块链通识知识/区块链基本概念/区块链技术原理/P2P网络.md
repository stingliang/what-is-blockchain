<!-- 
It is written by liangrui_ibilling,
email:liangrui_ibilling@si-tech.com
-->

## P2P网络

传统的网络服务架构大部分是客户端／服务端（client/server,C/S）架构，即通过一个中心化的服务端节点，对许多个申请服务的客户端进行应答和服务。C/S架构也称为主从式架构，其中服务端是整个网络服务的核心，客户端之间通信需要依赖服务端的协助。例如当前流行的即时通信（InstantMessage,IM）应用大多采用C/S架构：手机端APP仅被作为一个客户端使用，它们之间相互间收发消息需要依赖中心服务器。也就是说，在手机客户端之间进行消息收发时，手机客户端会先将消息发给中心服务器，再由中心服务器转发给接收方手机客户端。

![p2p](3584EFC384FB4A6093705DABC7A7D3BF)

C/S架构的优势非常明显且自然：单个的服务端能够保持一致的服务形式，方便对服务进行维护和升级，同时也便于管理。然而，C/S架构也存在很多缺陷。首先，由于C/S架构只有单一的服务端，因此当服务节点发生故障时，整个服务都会陷入瘫痪。另外，单个服务端节点的处理能力是有限的，因此中心服务节点的性能往往成为整体网络的瓶颈。

<u>对等计算机网络（Peer-to-PeerNetworking，P2P网络），是一种消除了中心化的服务节点，将所有的网络参与者视为对等者（Peer），并在他们之间进行任务和工作负载分配。</u>P2P结构打破了传统的C/S模式，去除了中心服务器，是一种依靠用户群共同维护的网络结构。由于节点间的数据传输不再依赖中心服务节点，P2P网络具有极强的可靠性，任何单一或者少量节点故障都不会影响整个网络正常运转。同时，P2P网络的网络容量没有上限，因为随着节点数量的增加，整个网络的资源也在同步增加。由于每个节点可以从任意（有能力的）节点处得到服务，同时由于P2P网络中暗含的激励机制也会尽力向其他节点提供服务，因此，实际上P2P网络中节点数目越多，P2P网络提供的服务质量就越高。

总的来说，虽然C/S架构应用非常成熟，但是这种存在中心服务节点的特性，显然不符合区块链去中心化的需求。同时，在区块链系统中，要求所有节点共同维护账本数据，即每笔交易都需要发送给网络中的所有节点。如果按照传统的C/S这种依赖中心服务节点的模式，中心节点需要大量交易信息转发给所有节点，这几乎是不可能完成的任务。P2P网络的这些设计思想则同区块链的理念完美契合。在区块链中，所有交易及区块的传播并不要求发送者将消息发送给所有节点。节点只需要将消息发送给一定数量的相邻节点即可，其他节点收到消息后，会按照一定的规则转发给自己的相邻节点。最终通过一传十、十传百的方式，最终将消息发送给所有节点。

以传统的银行系统为例。传统银行系统均采用C/S网络架构，即以银行服务器为中心节点，各个网点、ATM为客户端。当我们需要发起转账时，首先提供银行卡、密码等信息证明身份，然后生成一笔转账交易，发送到中心服务器后，由中心服务器校验余额是否充足等信息，然后记录到中心服务器，即可完成一笔转账交易。

而在区块链网络中，并不存在一个中心节点来校验并记录交易信息，校验和记录工作有网络中的所有节点共同完成。当一个节点需要发起转账时，需要指明转账目的地址、转账金额等信息，同时还需要对该笔交易进行签名。由于不存在中心服务器，该交易会随机发送到网络中的邻近节点，邻近节点收到交易消息后，对交易进行签名，确认身份合法性后，再校验余额是否充足等信息。均校验完成后，它则会将该消息转发至自己的邻近节点。以此重复，直至网络中所有节点均收到该交易。最后，矿工获得记账权后，则会将该交易打包至区块，然后再广播至整个网络。区块广播过程同交易的广播过程，仍然使用一传十、十传百的方式完成。收到区块的节点完成区块内容验证后，即会将该区块永久地保存在本地，即交易生效。

总结起来，P2P网络有以下特点

##### 非中心化

网络中的资源和服务分散在所有节点上，信息的传输和服务的实现都直接在节点之间进行，可以无需中间环节和服务器的介入，避免了可能的瓶颈。P2P的非中心化基本特点，带来了其在可扩展性、健壮性等方面的优势。

##### 可扩展性

在P2P网络中，随着用户的加入，不仅服务的需求增加了，系统整体的资源和服务能力也在同步地扩充，始终能比较容易地满足用户的需要。理论上其可扩展性几乎可以认为是无限的。例如：在传统的通过FTP的文件下载方式中，当下载用户增加之后，下载速度会变得越来越慢，然而P2P网络正好相反，加入的用户越多，P2P网络中提供的资源就越多，下载的速度反而越快。

##### 健壮性

P2P架构天生具有耐攻击、高容错的优点。由于服务是分散在各个节点之间进行的，部分节点或网络遭到破坏对其它部分的影响很小。P2P网络一般在部分节点失效时能够自动调整整体拓扑，保持其它节点的连通性。P2P网络通常都是以自组织的方式建立起来的，并允许节点自由地加入和离开。

##### 高性价比

性能优势是P2P被广泛关注的一个重要原因。随着硬件技术的发展，个人计算机的计算和存储能力以及网络带宽等性能依照摩尔定理高速增长。采用P2P架构可以有效地利用互联网中散布的大量普通结点，将计算任务或存储资料分布到所有节点上。利用其中闲置的计算能力或存储空间，达到高性能计算和海量存储的目的。目前，P2P在这方面的应用多在学术研究方面，一旦技术成熟，能够在工业领域推广，则可以为许多企业节省购买大型服务器的成本。

##### 隐私保护

在P2P网络中，由于信息的传输分散在各节点之间进行而无需经过某个集中环节，用户的隐私信息被窃听和泄漏的可能性大大缩小。此外，目前解决Internet隐私问题主要采用中继转发的技术方法，从而将通信的参与者隐藏在众多的网络实体之中。在传统的一些匿名通信系统中，实现这一机制依赖于某些中继服务器节点。而在P2P中，所有参与者都可以提供中继转发的功能，因而大大提高了匿名通讯的灵活性和可靠性，能够为用户提供更好的隐私保护。